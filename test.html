<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>Randell's Island Data Points</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
<style>
body { margin:0; padding:0; }
#map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>

<style>
#menu {
background: #fff;
position: absolute;
z-index: 1;
top: 10px;
right: 10px;
border-radius: 3px;
width: 120px;
border: 1px solid rgba(0,0,0,0.4);
font-family: 'Open Sans', sans-serif;
}

#menu a {
font-size: 13px;
color: #404040;
display: block;
margin: 0;
padding: 0;
padding: 10px;
text-decoration: none;
border-bottom: 1px solid rgba(0,0,0,0.25);
text-align: center;
}

#menu a:last-child {
border: none;
}

#menu a:hover {
background-color: #f8f8f8;
color: #404040;
}

#menu a.active {
background-color: #3887be;
color: #ffffff;
}

#menu a.active:hover {
background: #3074a4;
}
</style>

<nav id="menu"></nav>
<div id="map"></div>

<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoiam1raG9jaCIsImEiOiJjanIwb2FiNHEwZmJjM3lxdXlwMGU3ZGRpIn0.UC2gbIAqSoJbWuZ1JyB-tw';
var map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/light-v10',
  center: [-73.911464, 40.789793],
  zoom: 13.0
});

var places = {
  type: 'FeatureCollection',
  features: [{
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [-73.92551535, 40.80195842]
    },
    properties: {
      title: 'Bronx Kill - West End',
      description: 'One of the sampling sites'
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [-73.91627307, 40.79758124]
    },
    properties: {
      title: 'Bronx Kill - East End',
      description: 'One of the sampling sites'
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [-73.9277841, 40.7909416]
    },
    properties: {
      title: 'Little Hell Gate Salt Marsh',
      description: 'One of the sampling Sites'
    }
  }
]
};

map.on('load', function () {
  map.addSource('places', {
      "type": "geojson",
      "data": places
  });

  map.addLayer({
    "source": "places",
    'id': 'places',
'type': 'circle',
"interactive": true,
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(55,148,179,1)'
}
  });
map.addSource('Vegetation', {
type: 'vector',
url: 'mapbox://jmkhoch.cjsg8if770gxy2rpgqfjufj5e-6ofw0'
});
map.addLayer({
'id': 'Vegetation',
'type': 'circle',
'source': 'Vegetation',
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(0,128,0,1)'
},
'source-layer': 'Vegetation_Survey_Plots_LHGSM'
});

map.addSource('Birds', {
type: 'vector',
url: 'mapbox://jmkhoch.cjsg8hlb90fdf2xpe9ajo1vdw-8rq11'
});
map.addLayer({
'id': 'Birds',
'type': 'circle',
'source': 'Birds',
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(225,225,0,1)'
},
'source-layer': 'Wading_Bird_Count_Survey_Points_'
});

map.addSource('Fish', {
type: 'vector',
url: 'mapbox://jmkhoch.cjsg8g4sn0btk2wntepy64o3k-29zjm'
});
map.addLayer({
'id': 'Fish',
'type': 'circle',
'source': 'Fish',
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(0,0,255,1)'
},
'source-layer': 'Fish_Survey_Sites'
});

map.addSource('Vegetation_Bronx', {
type: 'vector',
url: 'mapbox://jmkhoch.cjsg8f8xg0xpi2xl66fk8aogz-1q7ip'
});
map.addLayer({
'id': 'Vegetation_Bronx',
'type': 'circle',
'source': 'Vegetation_Bronx',
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(0,255,0,1)'
},
'source-layer': 'Vegetation_Survey_Plots_Bronx_Ki'
});

map.addSource('Oyster_Cages', {
type: 'vector',
url: 'mapbox://jmkhoch.cjsg8eq7m116c2xmxg2riqgqr-6x6tv'
});
map.addLayer({
'id': 'Oyster_Cages',
'type': 'circle',
'source': 'Oyster_Cages',
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(128,128,128,1)'
},
'source-layer': 'Oyster_Cages'
});

map.addSource('Salt_Nutrients', {
type: 'vector',
url: 'mapbox://jmkhoch.cjsg8btz70f4i2wpglvzxrbt5-1m0jn'
});
map.addLayer({
'id': 'Salt_Nutrients',
'type': 'circle',
'source': 'Salt_Nutrients',
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(128,0,128,1)'
},
'source-layer': 'NutrientCyclingStudy_SampleSites'
});

map.addSource('CWQT_pilot', {
type: 'vector',
url: 'mapbox://jmkhoch.cjr88d2gi056632qcm1k0sypj-3i9cy'
});
map.addLayer({
'id': 'CWQT_pilot',
'type': 'circle',
'source': 'CWQT_pilot',
'layout': {
'visibility': 'visible'
},
'paint': {
'circle-radius': 8,
'circle-color': 'rgba(128,128,0,1)'
},
'source-layer': 'CWQT_pilot'
});


});

var toggleableLayerIds = [ 'places','Vegetation','Birds','Fish','Vegetation_Bronx','Oyster_Cages','Salt_Nutrients','CWQT_pilot'];

for (var i = 0; i < toggleableLayerIds.length; i++) {
var id = toggleableLayerIds[i];

var link = document.createElement('a');
link.href = '#';
link.className = 'active';
link.textContent = id;

link.onclick = function (e) {
var clickedLayer = this.textContent;
e.preventDefault();
e.stopPropagation();

var visibility = map.getLayoutProperty(clickedLayer, 'visibility');

if (visibility === 'visible') {
map.setLayoutProperty(clickedLayer, 'visibility', 'none');
this.className = '';
} else {
this.className = 'active';
map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
}
};

var layers = document.getElementById('menu');
layers.appendChild(link);
}

//major help - https://docs.mapbox.com/mapbox-gl-js/example/popup-on-click/
// https://docs.mapbox.com/help/tutorials/add-points-pt-3/
map.on('click', function(e) {
var features = map.queryRenderedFeatures(e.point, {
layers: ['places'] // replace this with the name of the layer
});

if (!features.length) {
return;
}

var feature = features[0];

var popup = new mapboxgl.Popup({ offset: [0, -15] })
.setLngLat(feature.geometry.coordinates)
.setHTML('<h3>' + feature.properties.title + '</h3><p>' + feature.properties.description + '</p>')
.setLngLat(feature.geometry.coordinates)
.addTo(map);
});

</script>

</body>
</html>
